(function(j){var a=setTimeout;function m(){}function h(p,o){return function(){p.apply(o,arguments)}}function i(o){if(typeof this!=="object"){throw new TypeError("Promises must be constructed via new")}if(typeof o!=="function"){throw new TypeError("not a function")}this._state=0;this._handled=false;this._value=undefined;this._deferreds=[];l(o,this)}function d(p,o){while(p._state===3){p=p._value}if(p._state===0){p._deferreds.push(o);return}p._handled=true;i._immediateFn(function(){var q=p._state===1?o.onFulfilled:o.onRejected;if(q===null){(p._state===1?k:n)(o.promise,p._value);return}var r;try{r=q(p._value)}catch(s){n(o.promise,s);return}k(o.promise,r)})}function k(o,q){try{if(q===o){throw new TypeError("A promise cannot be resolved with itself.")}if(q&&(typeof q==="object"||typeof q==="function")){var r=q.then;if(q instanceof i){o._state=3;o._value=q;f(o);return}else{if(typeof r==="function"){l(h(r,q),o);return}}}o._state=1;o._value=q;f(o)}catch(p){n(o,p)}}function n(o,p){o._state=2;o._value=p;f(o)}function f(p){if(p._state===2&&p._deferreds.length===0){i._immediateFn(function(){if(!p._handled){i._unhandledRejectionFn(p._value)}})}for(var q=0,o=p._deferreds.length;q<o;q++){d(p,p._deferreds[q])}p._deferreds=null}function g(q,o,p){this.onFulfilled=typeof q==="function"?q:null;this.onRejected=typeof o==="function"?o:null;this.promise=p}function l(r,p){var o=false;try{r(function(s){if(o){return}o=true;k(p,s)},function(s){if(o){return}o=true;n(p,s)})}catch(q){if(o){return}o=true;n(p,q)}}i.prototype["catch"]=function(o){return this.then(null,o)};i.prototype.then=function(q,p){var o=new (this.constructor)(m);d(this,new g(q,p,o));return o};i.all=function(o){var p=Array.prototype.slice.call(o);return new i(function(u,t){if(p.length===0){return u([])}var s=p.length;function r(w,y){try{if(y&&(typeof y==="object"||typeof y==="function")){var x=y.then;if(typeof x==="function"){x.call(y,function(z){r(w,z)},t);return}}p[w]=y;if(--s===0){u(p)}}catch(v){t(v)}}for(var q=0;q<p.length;q++){r(q,p[q])}})};i.resolve=function(o){if(o&&typeof o==="object"&&o.constructor===i){return o}return new i(function(p){p(o)})};i.reject=function(o){return new i(function(q,p){p(o)})};i.race=function(o){return new i(function(s,r){for(var q=0,p=o.length;q<p;q++){o[q].then(s,r)}})};i._immediateFn=(typeof setImmediate==="function"&&function(o){setImmediate(o)})||function(o){a(o,0)};i._unhandledRejectionFn=function e(o){if(typeof console!=="undefined"&&console){console.warn("Possible Unhandled Promise Rejection:",o)}};i._setImmediateFn=function c(o){i._immediateFn=o};i._setUnhandledRejectionFn=function b(o){i._unhandledRejectionFn=o};if(typeof module!=="undefined"&&module.exports){module.exports=i}else{if(!j.Promise){j.Promise=i}}})(this);